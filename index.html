<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PhysioCare - Ø­Ø¬Ø² Ø¬Ù„Ø³Ø©</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: 'Cairo', sans-serif;
      background: #f0f4f8;
      padding: 30px;
    }
    h2 {
      text-align: center;
      color: #023e8a;
    }
    form {
      max-width: 700px;
      margin: 0 auto;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #0077b6;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .toggle-btn, .back-btn {
      background-color: #0077b6;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 30px;
      cursor: pointer;
      transition: 0.3s;
      margin-top: 20px;
    }
    .toggle-btn:hover, .back-btn:hover {
      background-color: #0096c7;
    }
    .file-grid {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .file-box {
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      cursor: pointer;
    }
    .file-box:hover {
      transform: scale(1.03);
    }
    .file-box label {
      display: block;
      font-weight: bold;
      margin-bottom: 8px;
      color: #0077b6;
    }
    .file-box input {
      display: none;
    }
    .file-box span {
      font-size: 22px;
    }
    button[type="submit"] {
      background-color: #00b4d8;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      margin-top: 30px;
      cursor: pointer;
    }
    .success-message {
      display: none;
      text-align: center;
      margin-top: 40px;
      font-size: 20px;
      color: green;
    }
  </style>
</head>
<body>

<h2>Ù†Ù…ÙˆØ°Ø¬ Ø­Ø¬Ø² Ø¬Ù„Ø³Ø© Ø¹Ù„Ø§Ø¬ Ø·Ø¨ÙŠØ¹ÙŠ</h2>

<form id="bookingForm">
  <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ</label>
  <input type="text" name="fullName" required>

  <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
  <input type="tel" name="phone" required>

  <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø¥Ø¶Ø§ÙÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
  <input type="tel" name="phone2">

  <label>Ø´Ø±ÙƒØ© Ø§Ù„ØªØ£Ù…ÙŠÙ†</label>
  <input type="text" name="insurance" required>

  <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ù„Ø³Ø©</label>
  <input type="date" name="sessionDate" required>

  <label>Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©</label>
  <select name="sessionTime" required>
    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙØªØ±Ø© --</option>
    <option value="10:00 Øµ - 10:40 Øµ">10:00 Øµ - 10:40 Øµ</option>
    <option value="10:40 Øµ - 11:20 Øµ">10:40 Øµ - 11:20 Øµ</option>
    <option value="11:20 Øµ - 12:00 Ù…">11:20 Øµ - 12:00 Ù…</option>
    <option value="12:00 Ù… - 12:40 Ù…">12:00 Ù… - 12:40 Ù…</option>
    <option value="1:00 Ù… - 1:40 Ù…">1:00 Ù… - 1:40 Ù…</option>
    <option value="2:00 Ù… - 2:40 Ù…">2:00 Ù… - 2:40 Ù…</option>
    <option value="3:00 Ù… - 3:40 Ù…">3:00 Ù… - 3:40 Ù…</option>
    <option value="4:00 Ù… - 4:40 Ù…">4:00 Ù… - 4:40 Ù…</option>
    <option value="5:00 Ù… - 5:40 Ù…">5:00 Ù… - 5:40 Ù…</option>
    <option value="6:00 Ù… - 6:40 Ù…">6:00 Ù… - 6:40 Ù…</option>
    <option value="7:00 Ù… - 7:40 Ù…">7:00 Ù… - 7:40 Ù…</option>
    <option value="8:00 Ù… - 8:40 Ù…">8:00 Ù… - 8:40 Ù…</option>
    <option value="9:00 Ù… - 9:40 Ù…">9:00 Ù… - 9:40 Ù…</option>
  </select>

  <label>Ø§Ø®ØªØ± Ø§Ù„Ø´ÙŠÙØª</label>
  <select name="shift" required>
    <option value="">-- Ø§Ø®ØªØ± --</option>
    <option value="ØµØ¨Ø§Ø­ÙŠ">ØµØ¨Ø§Ø­ÙŠ</option>
    <option value="Ù…Ø³Ø§Ø¦ÙŠ">Ù…Ø³Ø§Ø¦ÙŠ</option>
  </select>

  <label>Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙƒØªÙˆØ±</label>
  <select name="doctor" required>
    <option value="">-- Ø§Ø®ØªØ± --</option>
    <option value="Ø¯. Ø£Ø­Ù…Ø¯ Ø®Ø§Ù„Ø¯">Ø¯. Ø£Ø­Ù…Ø¯ Ø®Ø§Ù„Ø¯</option>
    <option value="Ø¯. Ø³Ø§Ø±Ø© Ù…Ù†ØµÙˆØ±">Ø¯. Ø³Ø§Ø±Ø© Ù…Ù†ØµÙˆØ±</option>
    <option value="Ø¯. Ù…Ø­Ù…Ø¯ Ø¬Ù…Ø§Ù„">Ø¯. Ù…Ø­Ù…Ø¯ Ø¬Ù…Ø§Ù„</option>
    <option value="Ø¯. ÙŠØ§Ø³Ù…ÙŠÙ† Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡">Ø¯. ÙŠØ§Ø³Ù…ÙŠÙ† Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡</option>
  </select>

  <div class="upload-section">
    <button type="button" class="toggle-btn" onclick="toggleGrid()">ğŸ“ Ø¥Ø±ÙØ§Ù‚ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</button>
    <div class="file-grid" id="fileGrid">
      <div class="file-box"><label for="card">ÙƒØ§Ø±Ù†ÙŠÙ‡</label><span>ğŸ“</span><input type="file" id="card" name="card"></div>
      <div class="file-box"><label for="id">Ø¨Ø·Ø§Ù‚Ø©</label><span>ğŸ“</span><input type="file" id="id" name="id"></div>
      <div class="file-box"><label for="prescription">Ø±ÙˆØ´ØªØ©</label><span>ğŸ“</span><input type="file" id="prescription" name="prescription"></div>
      <div class="file-box"><label for="xray1">ØªÙ‚Ø±ÙŠØ± Ø£Ø´Ø¹Ø©</label><span>ğŸ“</span><input type="file" id="xray1" name="xray1"></div>
      <div class="file-box"><label for="xray2">Ø£Ø´Ø¹Ø© Ø£Ø®Ø±Ù‰</label><span>ğŸ“</span><input type="file" id="xray2" name="xray2"></div>
      <div class="file-box"><label for="report">ØªÙ‚Ø±ÙŠØ± Ø·Ø¨ÙŠ</label><span>ğŸ“</span><input type="file" id="report" name="report"></div>
      <div class="file-box"><label for="approval">Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</label><span>ğŸ“</span><input type="file" id="approval" name="approval"></div>
      <div class="file-box"><label for="other">Ø£Ø®Ø±Ù‰</label><span>ğŸ“</span><input type="file" id="other" name="other"></div>
    </div>
  </div>

  <button type="submit">Ø¥Ø±Ø³Ø§Ù„</button>
</form>

<div class="success-message" id="successMessage">
  âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­<br>
  Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø² Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ: <span id="bookingId"></span><br><br>
  <button class="back-btn" onclick="location.reload()">ğŸ”„ Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyA6_OACwpwaFSiX8jfsjS0_bt_EfIc4rhY",
    authDomain: "physiocare-booking.firebaseapp.com",
    projectId: "physiocare-booking",
    storageBucket: "physiocare-booking.firebasestorage.app",
    messagingSenderId: "815959251074",
    appId: "1:815959251074:web:cfd13396b4072b90ccbc9b",
    measurementId: "G-HBYJGQRVBB"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const storage = firebase.storage();

  function toggleGrid() {
    const grid = document.getElementById("fileGrid");
    grid.style.display = grid.style.display === "grid" ? "none" : "grid";
  }

  document.getElementById("bookingForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    const form = e.target;
    const data = {
      fullName: form.fullName.value,
      phone: form.phone.value,
      phone2: form.phone2.value || '',
      insurance: form.insurance.value,
      sessionDate: form.sessionDate.value,
      sessionTime: form.sessionTime.value,
      shift: form.shift.value,
      doctor: form.doctor.value,
      files: {}
    };

    const fileFields = ['card','id','prescription','xray1','xray2','report','approval','other'];
    for (const field of fileFields) {
      const fileInput = form[field];
      const file = fileInput.files[0];
      if (file) {
        const storageRef = storage.ref().child(`uploads/${Date.now()}_${file.name}`);
        await storageRef.put(file);
        const url = await storageRef.getDownloadURL();
        data.files[field] = url;
      }
    }

    const docRef = await db.collection("bookings").add(data);
    const bookingId = docRef.id;

    const message = `PhysioCare Booking âœ…
Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²: ${bookingId}
Ø§Ù„Ø§Ø³Ù…: ${data.fullName}
Ø§Ù„Ù‡Ø§ØªÙ: ${data.phone}
Ø´Ø±ÙƒØ© Ø§Ù„ØªØ£Ù…ÙŠÙ†: ${data.insurance}
Ø§Ù„Ø´ÙŠÙØª: ${data.shift}
Ø§Ù„Ø¯ÙƒØªÙˆØ±: ${data.doctor}
Ø§Ù„Ø¬Ù„Ø³Ø©: ${data.sessionDate} - ${data.sessionTime}`;

    const encodedMsg = encodeURIComponent(message);
    window.open(`https://wa.me/201024443117?text=${encodedMsg}`, '_blank'); // Ù„Ù„Ø¹ÙŠØ§Ø¯Ø©
    window.open(`https://wa.me/2${data.phone}?text=${encodedMsg}`, '_blank'); // Ù„Ù„Ø¹Ù…ÙŠÙ„

    form.style.display = "none";
    document.getElementById("bookingId").innerText = bookingId;
    document.getElementById("successMessage").style.display = "block";
  });
</script>

</body>
</html>
