<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PhysioCare | Ø­Ø¬Ø² Ø¬Ù„Ø³Ø© Ø¹Ù„Ø§Ø¬ Ø·Ø¨ÙŠØ¹ÙŠ</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; font-family: 'Cairo', sans-serif; background: #f1f1f1; color: #333; }
    header { background: #009688; padding: 30px; text-align: center; color: white; }
    .container {
      max-width: 750px; background: white; margin: 40px auto;
      padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    label { display: block; margin: 15px 0 5px; }
    input, select, textarea {
      width: 100%; padding: 12px; border: 1px solid #ccc;
      border-radius: 8px; font-size: 15px;
    }
    button {
      background: #009688; color: white; border: none; padding: 15px;
      width: 100%; font-size: 16px; border-radius: 8px;
      margin-top: 20px; cursor: pointer; transition: 0.3s ease;
    }
    button:hover { background: #00796b; }
    footer { text-align: center; color: #777; margin: 40px 0 10px; }
    .choice-group {
      display: flex; flex-wrap: wrap; justify-content: center;
      gap: 15px; margin: 10px 0 20px;
    }
    .choice-button {
      padding: 12px 20px; border: 2px solid transparent;
      background: #f0f0f0; color: #333; font-size: 16px;
      border-radius: 50px; cursor: pointer; transition: 0.3s ease-in-out;
      min-width: 130px; box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    .choice-button:hover {
      background: #e0f2f1; color: #00796b;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .choice-button.active {
      background: linear-gradient(to right, #009688, #00796b);
      color: white; border-color: #00695c;
      box-shadow: 0 4px 12px rgba(0,150,136,0.4);
    }
  </style>
</head>
<body>

<header>
  <h1>PhysioCare</h1>
  <p>Ø§Ø­Ø¬Ø² Ø¬Ù„Ø³ØªÙƒ Ø§Ù„Ø¹Ù„Ø§Ø¬ÙŠØ© Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ£Ù…Ø§Ù†</p>
</header>

<div class="container">
  <h2>Ù†Ù…ÙˆØ°Ø¬ Ø­Ø¬Ø² Ø¬Ù„Ø³Ø© Ø¹Ù„Ø§Ø¬ Ø·Ø¨ÙŠØ¹ÙŠ</h2>
  <form id="booking-form">
    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
    <input type="text" id="name" required placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø«Ù„Ø§Ø«ÙŠ">
    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
    <input type="tel" id="phone" required placeholder="01XXXXXXXXX">
    <label>Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ø­ØªÙŠØ§Ø·ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
    <input type="tel" id="alt-phone" placeholder="01XXXXXXXXX">
    <label>Ø´Ø±ÙƒØ© Ø§Ù„ØªØ£Ù…ÙŠÙ†</label>
    <div class="choice-group" id="insurance-buttons">
      <button type="button" class="choice-button" data-value="Globmed">Globmed</button>
      <button type="button" class="choice-button" data-value="NextCare">NextCare</button>
      <button type="button" class="choice-button" data-value="AXA">AXA</button>
      <button type="button" class="choice-button" data-value="Metlife (Alico)">Metlife (Alico)</button>
      <button type="button" class="choice-button" data-value="MedRight">MedRight</button>
      <button type="button" class="choice-button" data-value="Enppi">Enppi</button>
      <button type="button" class="choice-button" data-value="Bupa">Bupa</button>
      <button type="button" class="choice-button" data-value="Egymed">Egymed</button>
    </div>
    <input type="hidden" id="insurance">
    <label>Ø§Ø®ØªØ± Ø§Ù„ÙØ±Ø¹</label>
    <div class="choice-group" id="branch-buttons">
      <button type="button" class="choice-button" data-value="Ø¥ÙŠØ¯Ù† Ù…ÙˆÙ„ - Ø§Ù„Ø´ÙŠØ® Ø²Ø§ÙŠØ¯">Ø¥ÙŠØ¯Ù† Ù…ÙˆÙ„</button>
      <button type="button" class="choice-button" data-value="Ø£Ø±ÙƒØ§Ù† Ù…ÙˆÙ„ - Ø§Ù„Ø´ÙŠØ® Ø²Ø§ÙŠØ¯">Ø£Ø±ÙƒØ§Ù† Ù…ÙˆÙ„</button>
      <button type="button" class="choice-button" data-value="Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ">Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ</button>
      <button type="button" class="choice-button" data-value="Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†">Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†</button>
      <button type="button" class="choice-button" data-value="Ø§Ù„ØªØ¬Ù…Ø¹ Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„ØªØ¬Ù…Ø¹</button>
    </div>
    <input type="hidden" id="branch">
    <label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
    <input type="date" id="date" required>
    <label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´ÙŠÙØª</label>
    <div class="choice-group" id="shift-buttons">
      <button type="button" class="choice-button" data-value="ØµØ¨Ø§Ø­ÙŠ">ØµØ¨Ø§Ø­ÙŠ</button>
      <button type="button" class="choice-button" data-value="Ù…Ø³Ø§Ø¦ÙŠ">Ù…Ø³Ø§Ø¦ÙŠ</button>
    </div>
    <input type="hidden" id="shift">

    <div id="evening-options" style="display:none">
      <label>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¯ÙƒØ§ØªØ±Ø©</label>
      <input type="text" id="doctors" placeholder="Ù…Ø«Ø§Ù„: Ù…Ø­Ù…Ø¯ ØµØ§Ø¯Ù‚ØŒ Ù†ÙŠØ±Ù‡ Ø®Ø§Ù„Ø¯">
      <label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</label>
      <div class="choice-group" id="time-buttons">
        <button type="button" class="choice-button" data-value="4:30 Ù…">4:30 Ù…</button>
        <button type="button" class="choice-button" data-value="5:10 Ù…">5:10 Ù…</button>
        <button type="button" class="choice-button" data-value="5:50 Ù…">5:50 Ù…</button>
        <button type="button" class="choice-button" data-value="6:30 Ù…">6:30 Ù…</button>
        <button type="button" class="choice-button" data-value="7:10 Ù…">7:10 Ù…</button>
        <button type="button" class="choice-button" data-value="7:50 Ù…">7:50 Ù…</button>
        <button type="button" class="choice-button" data-value="8:30 Ù…">8:30 Ù…</button>
        <button type="button" class="choice-button" data-value="9:10 Ù…">9:10 Ù…</button>
        <button type="button" class="choice-button" data-value="9:50 Ù…">9:50 Ù…</button>
      </div>
      <input type="hidden" id="selected-time">
    </div>

    <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
    <textarea id="notes" rows="3" placeholder="Ù„Ùˆ ÙÙŠ Ø­Ø§Ø¬Ø© ØªØ­Ø¨ ØªÙˆØ¶Ø­Ù‡Ø§"></textarea>

    <h3>Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª</h3>
<div class="file-grid">
  <div class="file-box">
    <label><span class="icon">ğŸ“›</span> Ø§Ù„ÙƒØ§Ø±Ù†ÙŠÙ‡</label>
    <input type="file" id="file-carnet">
  </div>
  <div class="file-box">
    <label><span class="icon">ğŸªª</span> Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</label>
    <input type="file" id="file-id">
  </div>
  <div class="file-box">
    <label><span class="icon">ğŸ’Š</span> Ø§Ù„Ø±ÙˆØ´ØªØ©</label>
    <input type="file" id="file-prescription">
  </div>
  <div class="file-box">
    <label><span class="icon">ğŸ“</span> Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</label>
    <input type="file" id="file-approval">
  </div>
  <div class="file-box">
  <label>
    <img src="https://cdn-icons-png.flaticon.com/512/3649/3649466.png" alt="ØªÙ‚Ø±ÙŠØ± Ø£Ø´Ø¹Ø©" style="width:20px; vertical-align:middle; margin-left:6px;">
    ØªÙ‚Ø±ÙŠØ± Ø£Ø´Ø¹Ø©
  </label>
  <input type="file" id="file-xray1">
</div>
  <div class="file-box">
    <label><span class="icon">ğŸ“„</span> ØªÙ‚Ø±ÙŠØ± Ø·Ø¨ÙŠ</label>
    <input type="file" id="file-medical">
  </div>
  <div class="file-box">
    <label><span class="icon">ğŸ“</span> Ø£Ø®Ø±Ù‰</label>
    <input type="file" id="file-other">
  </div>
</div>

    <button type="submit">Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</button>
  </form>
</div>

<footer>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; PhysioCare 2025</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyA6_OACwpwaFSiX8jfsjS0_bt_EfIc4rhY",
    authDomain: "physiocare-booking.firebaseapp.com",
    projectId: "physiocare-booking",
    storageBucket: "physiocare-booking.firebasestorage.app",
    messagingSenderId: "815959251074",
    appId: "1:815959251074:web:cfd13396b4072b90ccbc9b"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
  const storage = firebase.storage();

  const activateChoice = (groupId, hiddenId) => {
    const buttons = document.querySelectorAll(`#${groupId} .choice-button`);
    const input = document.getElementById(hiddenId);
    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        buttons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        input.value = btn.dataset.value;
      });
    });
  };

  const activateMultiChoice = (groupId, hiddenId) => {
    const buttons = document.querySelectorAll(`#${groupId} .choice-button`);
    const input = document.getElementById(hiddenId);
    const selected = new Set();
    buttons.forEach(btn => {
      btn.addEventListener("click", () => {
        const val = btn.dataset.value;
        btn.classList.toggle("active");
        selected.has(val) ? selected.delete(val) : selected.add(val);
        input.value = Array.from(selected).join(", ");
      });
    });
  };

  activateChoice('branch-buttons', 'branch');
  activateChoice('shift-buttons', 'shift');
  activateChoice('insurance-buttons', 'insurance');
  activateMultiChoice('time-buttons', 'selected-time');

  document.querySelectorAll('#shift-buttons .choice-button').forEach(btn => {
    btn.addEventListener('click', () => {
      document.getElementById('evening-options').style.display = (btn.dataset.value === 'Ù…Ø³Ø§Ø¦ÙŠ') ? 'block' : 'none';
    });
  });

  document.getElementById("booking-form").addEventListener("submit", async function(e) {
    e.preventDefault();
    const btn = this.querySelector("button[type='submit']");
    btn.disabled = true;
    btn.textContent = "Ø¬Ø§Ø±Ù Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ø¬Ø²...";

    const name = document.getElementById("name").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const altPhone = document.getElementById("alt-phone").value.trim();
    const insurance = document.getElementById("insurance").value.trim();
    const branch = document.getElementById("branch").value.trim();
    const date = document.getElementById("date").value;
    const shift = document.getElementById("shift").value;
    const doctors = document.getElementById("doctors").value.trim();
    const time = document.getElementById("selected-time").value.trim();
    const notes = document.getElementById("notes").value.trim();

    if (!name || !phone || !insurance || !branch || !date || !shift) {
      alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§ÙƒÙ…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
      btn.disabled = false;
      btn.textContent = "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†";
      return;
    }

    if (shift === "Ù…Ø³Ø§Ø¦ÙŠ" && (!doctors || !time)) {
      alert("Ø¨Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ø§Ù„Ø¯ÙƒØªÙˆØ± ÙˆØ§Ù„Ù…ÙˆØ¹Ø¯.");
      btn.disabled = false;
      btn.textContent = "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†";
      return;
    }

    const fileInputs = {
      carnet: document.getElementById("file-carnet"),
      id: document.getElementById("file-id"),
      prescription: document.getElementById("file-prescription"),
      approval: document.getElementById("file-approval"),
      xray1: document.getElementById("file-xray1"),
      xray2: document.getElementById("file-xray2"),
      medical: document.getElementById("file-medical"),
      other: document.getElementById("file-other")
    };

    const uploadedFiles = {};
    const uploadFile = async (label, input) => {
      if (input && input.files.length > 0) {
        const file = input.files[0];
        const uniqueId = Date.now() + "_" + Math.floor(Math.random() * 10000);
        const ref = storage.ref(`bookings/${uniqueId}_${file.name}`);
        await ref.put(file);
        uploadedFiles[label] = await ref.getDownloadURL();
      }
    };

    try {
      await Promise.all(Object.entries(fileInputs).map(([k, v]) => uploadFile(k, v)));
      const bookingRef = await db.collection("bookings").add({
        name, phone, altPhone, insurance, branch, date, shift,
        doctors, time, notes, files: uploadedFiles,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      // Ø¥Ø±Ø³Ø§Ù„ ØªØ£ÙƒÙŠØ¯ ÙˆØ§ØªØ³Ø§Ø¨
      const msg = `ØªÙ… Ø­Ø¬Ø² Ø¬Ù„Ø³ØªÙƒ ÙÙŠ PhysioCare âœ…\nØ§Ù„ÙØ±Ø¹: ${branch}\nØ§Ù„ØªØ§Ø±ÙŠØ®: ${date}\nØ§Ù„ÙˆÙ‚Øª: ${time}\nØ§Ù„Ø§Ø³Ù…: ${name}`;
      window.open(`https://wa.me/2${phone.replace(/^0/, "")}?text=${encodeURIComponent(msg)}`, '_blank');

      alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­!");
      this.reset();
      btn.disabled = false;
      btn.textContent = "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†";
    } catch (err) {
      console.error(err);
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ø¬Ø². Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
      btn.disabled = false;
      btn.textContent = "Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†";
    }
  });
</script>

</body>
</html>
